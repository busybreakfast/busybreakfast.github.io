var main = {
  id:"main",
  data: [
	"Hello, my name is Yuriy. Welcome to our BA Final show",
	"I am UI/UX designer",
	"Shall I tell you more or you want to get in touch?",
	"<div id='learn' class='chat-button button'>Learn more</div> <div id='getin' class='chat-button button'>Get in touch</div>"
  ]
}

var weezzo_1 = {
  id: "weezzo_1",
  data: [
	"Great, am pleased",
	"I am the graphic designer with the speciality in user interfaces",
	"Or simply saying I am putting text on buttons and then arrange them on screen :)",
	"For example, I've done a financial project with a lot of buttons called Weezoo",
	"<a href='projects/2017-04-24-weezzo.html' target='blank'><img class='ing-chat' src='/weezzo-chat.png' class='ing-chat'/></br>More about the project</a>",
	"<div id='w_like' class='chat-button button'>Like it!</div> <div  id='w_no' class='chat-button button'>It's no fun</div>"
  ]
}

var card = {
  id: "card",
  data: [
	"I do appreciate your attention",
	"Here is my digital business card",
	"<a href='mailto:yuriysteam@icloud.com'><div class='contact-icon'><img src='/e-mail.png'><span class='contact-detail-text'>Email</span></div></a><div class='clear'></div><a href='facetime-audio:yuriysteam@icloud.com'> <div class='contact-icon'><img src='/facetime.png'><span class='contact-detail-text'>FaceTime Audio</span></div></a><div class='clear'></div><div class='icons-margin'><a href='https://twitter.com/YuriySteam' target='blank'> <div class='contact-icon'><img src='/twitter.png'></div></a><a href='https://dribbble.com/YuriySteam' target='blank'> <div class='contact-icon'><img src='/drb.png'></div></a><a href='https://www.instagram.com/yuriysteam/' target='blank'> <div class='contact-icon'><img src='/ing.png'></div></a></div><div class='clear'></div>",
	"Do you want to talk about some specifics project or maybe see an example of my work? ",
	"<div id='card_b' class='chat-button button'>I have project</div> <div  id='card_w' class='chat-button button'>Show your work</div>"
  ]
}

var car_ui = {
  id: "car_ui",
  data: [
	"Great, we speak same language!",
	"Ok. One more",
	"For the school final show, I tried to imagine how car UI of the future will look like",
	  "<a href='/projects/2017-04-24-car-ui.html' target='blank'><img src='/car-chat.png' class='ing-chat'/></br>More about the project</a>",
	"<div id='car_y' class='chat-button button'>Looks cool</div> <div  id='car_n' class='chat-button button'>Nah! :| </div>"
  ]
}

var taste = {
  id: "taste",
  data: [
	"You have a great taste I shall admit :)",
	"Would you want to talk about design or look at other works?",
	  "<div id='taste_y' class='chat-button button'>Let's talk!</div> <div  id='brows' class='chat-button button'>Browse more</div>"
  ]
}

var prg_1 = {
  id: "prg_1",
  data: [
	"I  will be happy to discuss your work or new design trends",
	"Are you in Prague maybe?",
	  "<div id='prg_y' class='chat-button button'>Yes!</div> <div  id='prg_n' class='chat-button button'>Nope :P</div>"
  ]
}

var coffee = {
  id: "coffee",
  data: [
	"Great. Do you like coffee?",
	  "<div id='coffee_y' class='chat-button button'>Yes</div> <div  id='coffee_n' class='chat-button button'>No</div>"
  ]
}

var drink = {
  id: "drink",
  data: [
	"Okey. Drop me a line and we can meet.",
	  "Looking forward to talking to you",
	  "<a href='mailto:yuriysteam@icloud.com'><div class='contact-icon'><img src='/e-mail.png'><span class='contact-detail-text'>Email</span></div></a><div class='clear'></div><a href='facetime-audio:yuriysteam@icloud.com'> <div class='contact-icon'><img src='/facetime.png'><span class='contact-detail-text'>FaceTime Audio</span></div></a><div class='clear'></div></br><a href='https://twitter.com/YuriySteam' target='blank'> <div class='contact-icon'><img src='/twitter.png'></div></a><a href='https://dribbble.com/YuriySteam' target='blank'> <div class='contact-icon'><img src='/drb.png'></div></a><a href='https://www.instagram.com/yuriysteam/' target='blank'> <div class='contact-icon'><img src='/ing.png'></div></a><div class='clear'></div>",
	  "<img src='tea.gif'>"
  ]
}

var biz = {
  id: "biz",
  data: [
	  "Superb!",
	  "Like your attitude. I will ask you to tell me about your project, so I can prepare",
	  "What do you need? Logo, interface or typeface? Tell me in the form",
	  "{form for this}",
	  "What do you need it for? Is it your company? Do you want to promote something? What problem are you trying to solve?",
	  "{form for this}",
	  "And now, please, leave the e-mail, so I can contact you",
	  "{form for e-mail}",
	  "Gotcha. All noted, saved and I am already thinking about the solution.",
	  "<img src='work.gif'>"

  ]
}

var weezzo_2 = {
  id: "weezzo_2",
  data: [
	"Thank you for your interest",
	  "Recently, I've done a great financial project called Weezzo",
	  "<a href='projects/2017-04-24-weezzo.html' target='blank'><img src='/weezzo-chat.png' class='ing-chat'/></br>More about the project</a>",
	  "<div id='weezzo__2_y' class='chat-button button'>Like it!</div> <div  id='weezzo__2_n' class='chat-button button'>Something else?</div>"
  ]
}

var brand_t = {
  id: "brand_t",
  data: [
	"Hm, what about brand identity?",
	  "Or maybe type design?",
	  "<div id='brand_1' class='chat-button button'>Brands</div> <div  id='type_1' class='chat-button button'>Typedesign</div>"
  ]
}


var reetimee = {
  id: "reetimee",
  data: [
	"So brands it is",
	  "Here is an identity I did for a luxury fashion brand",
	  "I like when a client is fully involved and this project is the great example",
	  "<a href='/projects/2016-04-30-reetimee.html' target='blank'><img src='/brand-chat.png' class='ing-chat'/></br>More about the project</a>",
	  "<div id='reetimee_y' class='chat-button button'> I like these things!</div> <div  id='reetimee_n' class='chat-button button'>Still no fun :(</div>"
  ]
}

var negative = {
  id: "negative",
  data: [
	"I guess we have different tastes...",
	  "And this is cool.",
	  "Tell me, what do you like? Or share what you are working on? Drop a line or share link.",
	   "<input type='text' class='chat-text'>",
	  "<div id='send_n' class='chat-button button'>Send</div>"

  ]
}

var follow_up = {
  id: "follow_up",
  data: [
	"Thank you for this",
	  "I will be gone. For now",
	  "<img src='ninja.gif'>"
  ]
}

var prg_2 = {
  id: "prg_2",
  data: [
	 "Aha, so you live abroad",
	  "Always wanted to meet awesome designers from foreign countries.",
	  "Here is my card",
	  "<a href='mailto:yuriysteam@icloud.com'><div class='contact-icon'><img src='/e-mail.png'><span class='contact-detail-text'>Email</span></div></a><div class='clear'></div><a href='facetime-audio:yuriysteam@icloud.com'> <div class='contact-icon'><img src='/facetime.png'><span class='contact-detail-text'>FaceTime Audio</span></div></a><div class='clear'></div></br><a href='https://twitter.com/YuriySteam' target='blank'> <div class='contact-icon'><img src='/twitter.png'></div></a><a href='https://dribbble.com/YuriySteam' target='blank'> <div class='contact-icon'><img src='/drb.png'></div></a><a href='https://www.instagram.com/yuriysteam/' target='blank'> <div class='contact-icon'><img src='/ing.png'></div></a><div class='clear'></div>",
	  "Drop me a line. I like travel places",
	  "Looking forward to talking to you.",
	  "<img src='tea.gif'>"

  ]
}

var tea = {
  id: "tea",
  data: [
	"Maybe a cup of tea?",
	  "<div id='tea_y' class='chat-button button'>Why not?</div> <div  id='tea_n' class='chat-button button'>No</div>"
  ]
}

var tea_f = {
  id: "tea_f",
  data: [
	 "Hm.",
	  "I really underestimated your beverage choices.",
	  "Well, at least we are certain about design.",
	  "Drop me a line and let's meet.",
	  "<a href='mailto:yuriysteam@icloud.com'><div class='contact-icon'><img src='/e-mail.png'><span class='contact-detail-text'>Email</span></div></a><div class='clear'></div><a href='facetime-audio:yuriysteam@icloud.com'> <div class='contact-icon'><img src='/facetime.png'><span class='contact-detail-text'>FaceTime Audio</span></div></a><div class='clear'></div></br><a href='https://twitter.com/YuriySteam' target='blank'> <div class='contact-icon'><img src='/twitter.png'></div></a><a href='https://dribbble.com/YuriySteam' target='blank'> <div class='contact-icon'><img src='/drb.png'></div></a><a href='https://www.instagram.com/yuriysteam/' target='blank'> <div class='contact-icon'><img src='/ing.png'></div></a><div class='clear'></div>",
	  "Looking forward to talk to you.",
	  "<img src='tea.gif'>"

  ]
}

var typog = {
  id: "typog",
  data: [
	"So typography it is",
	  "I did two typefaces",
	  "<a href='/projects/2016-02-23-ylla.html' target='blank'><img src='/ylla-chat.png' class='ing-chat'/></br>More about Finnish typeface project</a>",
	  "<a href='/projects/2017-04-24-lijinen.html' target='blank'><img src='/lijnen-chat.png' class='ing-chat'/></br>More about lijnen</a>",
	  "<div id='typog_y' class='chat-button button'>This is my type of work!</div> <div  id='typog_n' class='chat-button button'>Nah</div>"
  ]
}

var fotograf = {
  id: "fotograf",
  data: [
	"Great, great",
	  "I like branding too, because it express the whole idea or message of the company or person.",
	  "Like I did for Czech photography magazine",
	  "<a href='/projects/2016-04-29-fotograf.html' target='blank'><img src='/fotograf-chat.png' class='ing-chat'/></br>More about this magazine</a>",
	  "<div id='fotograf_y' class='chat-button button'>Looks cool</div> <div  id='fotograf_n' class='chat-button button'>Now you lost me</div>"
  ]
}

var portfolio = {
  id: "portfolio",
  data: [
	"Ok",
	  "What ifâ€¦",
	  "Maybe something from my portfolio will be interesting for you?",
	  "<a href='/projects/2016-04-30-reetimee.html' target='blank'><img src='/brand-chat.png' class='ing-chat'/></br>More about this fashion work</a>",
	  "<a href='/projects/2016-05-01-profinacie.html' target='blank'><img src='/app-chat.png' class='ing-chat'/></br>More about this app</a>",
	  "<div id='portfolio_y' class='chat-button button'>Not bad. Not bad.</div> <div  id='portfolio_n' class='chat-button button'>Still no fun :(</div>"
  ]
}

var portfolio_link = {
  id: "portfolio_link",
  data: [
	 "Scroll down, please, to see all works."
  ]
}


$(function() {
  renderChatMessages(main);

  $(document).on('click', '.chat-button', function(el){
	var buttonName = el.currentTarget.id;
	var buttonContext = $(el.currentTarget.parentElement).data('id');
	var btnPosition = $(el.currentTarget).position();

	hideButtons(buttonContext);
	showActiveButton(buttonName, btnPosition);

	switch(buttonName) {
	  case 'learn':
		  clickChatButton(weezzo_1);
		  break;
	case 'getin':
		  clickChatButton(card);
		  break;
	case 'card_b':
		  clickChatButton(biz);
		  break;
	  case 'w_like':
		  clickChatButton(car_ui);
		  break;
	  case 'car_y':
		  clickChatButton(taste);
		  break;
		case 'taste_y':
		  clickChatButton(prg_1);
		  break;
	  case 'prg_y':
		  clickChatButton(coffee);
		  break;
		case 'coffee_y':
		  clickChatButton(drink);
		  break;
		case 'card_w':
		  clickChatButton(weezzo_2);
		  break;
		case 'weezzo__2_y':
		  clickChatButton(car_ui);
		  break;
		case 'w_no':
		  clickChatButton(brand_t);
		  break;
		case 'brand_1':
		  clickChatButton(reetimee);
		  break;
			case 'reetimee_y':
		  clickChatButton(fotograf);
		  break;
		case 'reetimee_n':
		  clickChatButton(negative);
		  break;
		case 'fotograf_y':
		  clickChatButton(taste);
		  break;
			case 'brows':
		  clickChatButton(portfolio_link);
		  break;
		case 'fotograf_n':
		  clickChatButton(negative);
		  break;
			case 'weezzo__2_n':
		  clickChatButton(brand_t);
		  break;
			case 'prg_n':
		  clickChatButton(prg_2);
		  break;
				case 'tea_n':
		  clickChatButton(tea_f);
		  break;
				case 'tea_y':
		  clickChatButton(drink);
		  break;
				case 'coffee_n':
		  clickChatButton(tea);
		  break;
			case 'type_1':
		  clickChatButton(typog);
		  break;
			case 'typog_y':
		  clickChatButton(prg_1);
		  break;
			case 'fotograf_y':
		  clickChatButton(taste);
		  break;
		case 'fotograf_n':
		  clickChatButton(negative);
		  break;
		case 'car_n':
		  clickChatButton(portfolio);
		  break;
			case 'portfolio_y':
		  clickChatButton(taste);
		  break;
		case 'portfolio_n':
		  clickChatButton(negative);
		  break;
		case 'typog_n':
		  clickChatButton(negative);
		  break;
		case 'send_n':
		  clickChatButton(follow_up);
		  break;
	}
  })

});

function renderChatMessages(msgArray) {
	var div, chdiv;
	for (var i = 0; i < msgArray.data.length; i++)
	{
		var listItem = '';
		var item = msgArray.data[i];
		var n = item.includes("class='chat-button button'");
		div = document.createElement("div");
		div.className = 'list-item '+msgArray.id;
		chdiv = document.createElement("div");

		if (n)
		{
			div.className += " is-buttons";
			chdiv.className = "buttons-area";
			chdiv.id = msgArray.id;
			chdiv.innerHTML = msgArray.data[i];
		}
		else
		{
			div.className += " is-message";
			div.id = msgArray.id+i;
			chdiv.className = "message";
			chdiv.id = msgArray.id;
			chdiv.innerHTML = "<span class='chat-dots'><span class='dot'></span></span>";
		}
		div.appendChild(chdiv);
		$(".chat-wrapper").append(div);

		(function(div, content, i){
			setTimeout(function(){
				showAnimate(div, content);
			}, i * 2000);
		})(div, (!n ? msgArray.data[i] : null), i);
	}

   var scrollToEl = '#' + msgArray.id + '0';
   $('html, body').animate({
		 scrollTop: $(scrollToEl).offset().top-180
	 }, 900);
}

function clickChatButton(branch) {
	renderChatMessages(branch);
}

function showAnimate(div, text) {

	setTimeout(function(){
		$(div).addClass("is-visible");

		if (!text)
			return true;

		setTimeout(function(){
			$(div).find(".chat-dots").addClass("is-hidden");
			setTimeout(function(){
				var m = div.children[0];
				var w = $(m).width();
				var h = $(m).height();
				m.innerHTML = text;
				var w2 = $(m).width();
				var h2 = $(m).height();
				$(m).width(w);
				$(m).height(h);
				setTimeout(function(){
					$(m).addClass("is-animate");

					setTimeout(function(){
						$(m).width(w2);
						$(m).height(h2);
						setTimeout(function(){
							$(m).removeAttr("style");
							$(m).addClass("is-visible");
						}, 650);
					}, 1);

				}, 1);
			}, 1);
		}, 1400);

	}, 750);
}

function hideButtons(buttonContext) {
	$(".buttons-area[data-id='"+buttonContext+"'] .chat-button").hide().removeClass('chat-button');
}

function showActiveButton(buttonName, btnPosition) {
	var $button = $('#'+buttonName);
	$button.css({right: $button.parent().width()-($button.offset().left+$button.outerWidth()), position: 'absolute'});
	$button.parent().find(".button:not(#"+buttonName+")").hide();
	setTimeout(function(){
		$button.addClass("is-chosen");
		$button.removeAttr("style");
	}, 1);
}